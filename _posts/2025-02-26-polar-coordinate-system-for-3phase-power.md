---
layout: post
title: 极坐标在三相电力系统中的计算优势
tags: [三相电, svpwm]
---

在三相电力系统里，我们有三个相位差 120° 的火线。于是，也就有了三个相位差120°的电压和电流矢量。

三相平衡的前提下。对这个三相的电压电流矢量进行计算的时候，为了方便计算，会用到 park 和 clark 变换。目的是转成2个互相垂直的矢量。需要考虑的矢量个数，就从3个降到了2个。

但是，如果引入 极坐标系统，那么三相平衡的前提下，这3个电压矢量，就可以在极坐标下，合成为一个电压矢量。3个电流矢量，在极坐标系下就可以合成为一个电流矢量。

并且二者可以使用同一个坐标系。不需要专门引入一个旋转的坐标系。当然，就算要引入旋转坐标系，在极坐标系体系里，在原点旋转只需要一个加法。因为在三相平衡的条件下，电压和电流矢量都是从原点开始的。

在极坐标下，三相电压可以描述为  （ Vmax ，θv）。其中 Vmax 是相电压最大值，而 θv 为相位。
同理，三相对称电流也可以描述为 （Imax, θi）。其中 Imax 是相电流的最大值。而 θi 为相位。

虽然最终用于描述的变量都是2个。在 直角坐标系下，经过 clark 变换后， 电压也是描述为 (Ualpha , Ubeta)。
但是极坐标体系对计算过程更友好了。

比如，判定功率因素，只需要将 电压和电流的 相位相减，然后求余弦即可。
比如，计算有功功率，`Vmax*Imax*cos(θv - θi)。`。

在 foc 的控制中，我们主要的控制目标，就是 让 `θi - θe = 90°`。其中， θe 为转子的电角度。控制方式为调整 θv 相对 θe 的提前量。范围是 (θv - θe) ∈ [90°， 180°)。 本环应该采取慢速环。控制带宽应该低于电机的转动惯量。以免电流测量带来的 θi 高频波动影响 θv。

其次对扭矩的控制，我们主要控制 Imax = Iref 即可。而电流属于间接控制。其内环是 电压环。
电压环的控制目标，就是 Vmax。控制 Vmax = Vref 即可。

功率控制，就是 控制 `Vmax*Imax*cos(θv - θi) = Pref`。也是属于间接控制，内环还是电压环。

电压环应该采取快速环策略。使用逐周期控制。并且对 上层的 功率控制环和电流控制环，采取 双环竞争的策略。

由于电压是输出的，因此需要设计在 极坐标系下的 svpwm 调制算法。其实根据 θv 可以直接判断扇区，非常简单。

而主要的变换，在于测量获得三相电流后，如何反向构建为（Imax, θi）。 其实方法也很简单，就是在极坐标系下的 (Ia, 0°)，(Ib, 120°)，(Ib, 240°) 三个矢量合成。为一个 （Imax, θi）。

而且计算过程并不复杂。首先根据 Ia Ib Ic 的符号，判定扇区。和svpwm是一样的。

接下来就是根据扇区，计算 I1 I2 . 然后根据  I1 I2 反推出矢量的夹角。计算过程本质上是 svpwm 的逆运算。

