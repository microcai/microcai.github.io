---
layout: post
title: 反激电源里 tl431+pc817 组合下对比 Boost 是怎么实现稳压的
tags: [TL431, PC817, 反激, ACDC]
---

以前说过，反激就是隔离的 Boost。

在 Boost 升压电路里，稳压靠的是 一个分压网络和芯片的 FB 引脚。
芯片自动调节占空比，使得 FB 引脚电压被稳定在内部参考电压。从而间接的将输出电压稳定。

在反激电源里，同样也是靠芯片的 FB 引脚反馈。但是此时反馈信号来自 PC817 而不是分压电阻。
pc817 则受 tl431 驱动。

实际上，这里和 boost 拓扑里是一样的。就是比较分压和参考电压。
在 Boost 拓扑里，参考电压是芯片内置的。而在 pc817+tl431 的组合里，这个参考电压，就是 tl431。

tl431 通过控制 pc817 的导通，来间接调控反激控制器的占空比。tl431 流过电流越大，则 pc817 的内部发光二极管
流过的电流也越大。于是 pc817 的输出三极管的电流也越大。

pc817 通常用于将反激芯片的 FB 引脚（芯片会内部上拉）拉低。也就是 pc817 的二极管流过电流越大，反激芯片的 FB 引脚电压就被拉的越低。

反激芯片的 FB 引脚电压越低，反激芯片的 pwm 占空比就越低。

以DK1203为例子，他的 FB 引脚电压在 2.3V-2.5V 之间可以线性的调控占空比 0%-100%。高于 2.6V 芯片进入短路保护，低于 2.3V 芯片进入过压保护。
因此， tl431 可以通过 pc817 直接调控反激芯片的占空比。从而稳定输出电压。

如果将 boost 芯片用于反激，则 pc817 的输出要改成对 FB 进行上拉。

有一些boost控制器的 FB 引脚对应的内部比较器的 输出端也会引出。通常标记为 COMP 引脚。这种情况下，只需要将 FB 接地，然后用 pc817 拉低 COMP 引脚。
因为这种设计下，COMP 引脚的电压直接决定了占空比。FB 接地会使得 COMP 引脚事实上处于被运放持续拉高的状态。由于运放的输出电流有限，他拗不过 pc817，
因此 pc817 可以将 COMP 的电压拉低。

接下来讲下 tl431 的几个电阻的阻值如何确定。

![](/images/tl431+pc817.png)

这里， R24 的作用，是给 tl431 一个偏置电流。
为何呢？因为 tl431 要工作，肯定是要吃电流的。如果 pc817 直接串入 tl431， 意味着在任何情况下， pc817 的发光二极管都处于导通状态。这是我们要避免的。
因此， 12V 供电通过 R24 后再流入 tl431 . 然后 pc817 使用 R24 上的分压供电。

当 tl431 上流过的电流超过 1.2mA 的时候， R24 上产生 1.2V 的压降，于是 pc817 才会开始导通。

这样可以确保， tl431 有一个安全的 1.2mA 工作电流，在这个电流以下，pc817 绝对不会工作。

根据手册， tl431 要求 1mA 静态工作电流。因此 R24 这里取值 1.2K 也是没问题的。

当 tl431 的 2脚电压高于 2.5V ，tl431 就开始吃电流。他吃多少电流，就取决于2脚电压比 2.5V 高多少。最大能吃到 100mA 电流。

如果他吃 100mA 电流，则 R24 上会产生 100V 电压——这当然是不可能的。所以这个电路里， tl431吃不了那么大电流。但是吃 10mA 电流还是可以的。此时 R24 上会产生 10V 的分压 —— 如果不加以限制，10V 的电压足以烧毁 pc817 的发光二极管。因此 R27 的作用，就是限制流过 pc817 的电流，保护 pc817 的发光二极管。1k 的阻值，足够确保 pc817 的发光二极管。上的电流不会超过最大值值。

R23 和 R26 是一个典型的分压网络。只要记得 R26 不要超过 10k 就可以。因为 tl431 的 2脚会吃掉一个微弱的电流。这导致 R23 不能太大，导致 R26 实际上分不到那么多电压。一般我们要让 R26 上流过的电流十倍于 tl431 的 2脚吃掉的电流。而 R26 上流过的电流就是 2.5V/R26 。

接下来，确定 C12 C13 R25 的值。
这是一个2型补偿器。

因此，他的目的，就是防止 tl431 振荡。aka，这个带通滤波器的目的，就是将 tl431的 1脚调控路径 —— tl431 + pc817 + 反击芯片 + 变压器 这样一条长反射弧构成的变化。给提前反馈给 2脚。从而避免反馈延迟导致的 PID 振荡。
如果 1脚的反馈，总是提前补到2脚——则 占空比永远不可能发生真正的变化。
因此，我们要将 tl431 里，速度慢的反馈给过滤掉，速度快的反馈给提前补偿到2脚。

所谓 速度慢的反馈，其实就是  " tl431 + pc817 + 反击芯片 + 变压器 这样一条长反射弧" 的动态响应频率。
低于这个频率的，就反馈给芯片，高于这个频率的，就给直接补到2脚。这样就避免了 PID 震荡。

这就是这个带通滤波器的存在意义。
因此，需要实际进行调试后，确定你设计的电路的响应频率，然后确定带通滤波器的截止频率。然后由截止频率调整滤波器参数。

不过，也可以根据经验进行。一般  tl431 + pc817 + 反击芯片 + 变压器 这样一条长反射弧的响应频率在 1khz 左右。

因此，高于 1khz 的调整信号应该过滤掉不反馈给 pc817 避免震荡。

因此设计截止频率 1khz 的滤波器放置在 tl431 的 1 2 脚之间。只有低于 1khz 的信号传给 pc817 。

